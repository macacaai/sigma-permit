import{s as Jt,u as qt,v as el,w as Nl,x as Sl,y as Ol,z as Pl,d as f,r as It,B as Lt,m as c,J as mt,a as Ce,F as ge,N as El,i as te,b as s,l as le,G as Vl,K as At,c as u,e as v,p as z,g as E,f as A,h as d,j as T,t as U,I as Ml,n as gt,L as Ut,A as Ot,C as Pt,o as Al,q as Ul,M as tl}from"../chunks/BM_9wLIj.js";import{S as Ft,i as Rt,d as Ne,t as ue,a as ne,m as Se,b as Oe,e as Pe,g as Bt,c as jt,f as Vt}from"../chunks/DQoX3H7n.js";import{e as ot,l as Dt,t as ft,g as Bl,d as jl}from"../chunks/CEGMbthI.js";import{M as Mt}from"../chunks/8TY9-p5I.js";import{L as zl}from"../chunks/DdsxKvKa.js";import{R as Hl,P as Tl,T as wl,S as ql}from"../chunks/lZ7b4qBu.js";import{K as Jl}from"../chunks/CiUCNbTs.js";import{I as Fl,g as Rl,a as Gl}from"../chunks/k9BU4UWw.js";import{E as Kl}from"../chunks/DkGKUkHf.js";import{D as Yl}from"../chunks/CG1XVky_.js";function Zl(n){let e;const t=n[2].default,l=Nl(t,n,n[3],null);return{c(){l&&l.c()},l(a){l&&l.l(a)},m(a,r){l&&l.m(a,r),e=!0},p(a,r){l&&l.p&&(!e||r&8)&&Sl(l,t,a,a[3],e?Pl(t,a[3],r,null):Ol(a[3]),null)},i(a){e||(ne(l,a),e=!0)},o(a){ue(l,a),e=!1},d(a){l&&l.d(a)}}}function Ql(n){let e,t;const l=[{name:"calendar"},n[1],{iconNode:n[0]}];let a={$$slots:{default:[Zl]},$$scope:{ctx:n}};for(let r=0;r<l.length;r+=1)a=qt(a,l[r]);return e=new Fl({props:a}),{c(){Pe(e.$$.fragment)},l(r){Oe(e.$$.fragment,r)},m(r,i){Se(e,r,i),t=!0},p(r,[i]){const o=i&3?Rl(l,[l[0],i&2&&Gl(r[1]),i&1&&{iconNode:r[0]}]):{};i&8&&(o.$$scope={dirty:i,ctx:r}),e.$set(o)},i(r){t||(ne(e.$$.fragment,r),t=!0)},o(r){ue(e.$$.fragment,r),t=!1},d(r){Ne(e,r)}}}function Wl(n,e,t){let{$$slots:l={},$$scope:a}=e;const r=[["path",{d:"M8 2v4"}],["path",{d:"M16 2v4"}],["rect",{width:"18",height:"18",x:"3",y:"4",rx:"2"}],["path",{d:"M3 10h18"}]];return n.$$set=i=>{t(1,e=qt(qt({},e),el(i))),"$$scope"in i&&t(3,a=i.$$scope)},e=el(e),[r,e,l,a]}class Xl extends Ft{constructor(e){super(),Rt(this,e,Wl,Ql,Jt,{})}}function ll(n,e,t){const l=n.slice();return l[19]=e[t],l}function nl(n,e,t){const l=n.slice();return l[22]=e[t],l}function sl(n){let e,t=n[22].name+"",l,a;return{c(){e=d("option"),l=U(t),this.h()},l(r){e=u(r,"OPTION",{});var i=v(e);l=A(i,t),i.forEach(f),this.h()},h(){e.__value=a=n[22].id,ge(e,e.__value)},m(r,i){te(r,e,i),s(e,l)},p(r,i){i&2&&t!==(t=r[22].name+"")&&Ce(l,t),i&2&&a!==(a=r[22].id)&&(e.__value=a,ge(e,e.__value))},d(r){r&&f(e)}}}function al(n){let e,t=n[5].tenant_id+"",l;return{c(){e=d("p"),l=U(t),this.h()},l(a){e=u(a,"P",{class:!0});var r=v(e);l=A(r,t),r.forEach(f),this.h()},h(){c(e,"class","mt-1 text-sm text-red-600")},m(a,r){te(a,e,r),s(e,l)},p(a,r){r&32&&t!==(t=a[5].tenant_id+"")&&Ce(l,t)},d(a){a&&f(e)}}}function rl(n){let e,t=n[19].name+"",l,a;return{c(){e=d("option"),l=U(t),this.h()},l(r){e=u(r,"OPTION",{});var i=v(e);l=A(i,t),i.forEach(f),this.h()},h(){e.__value=a=n[19].id,ge(e,e.__value)},m(r,i){te(r,e,i),s(e,l)},p(r,i){i&4&&t!==(t=r[19].name+"")&&Ce(l,t),i&4&&a!==(a=r[19].id)&&(e.__value=a,ge(e,e.__value))},d(r){r&&f(e)}}}function ol(n){var r;let e,t,l=(((r=n[2].find(n[15]))==null?void 0:r.name)||"Unknown")+"",a;return{c(){e=d("p"),t=U("Selected: "),a=U(l),this.h()},l(i){e=u(i,"P",{class:!0});var o=v(e);t=A(o,"Selected: "),a=A(o,l),o.forEach(f),this.h()},h(){c(e,"class","mt-1 text-xs text-blue-600")},m(i,o){te(i,e,o),s(e,t),s(e,a)},p(i,o){var h;o&12&&l!==(l=(((h=i[2].find(i[15]))==null?void 0:h.name)||"Unknown")+"")&&Ce(a,l)},d(i){i&&f(e)}}}function il(n){let e,t;return{c(){e=d("p"),t=U(n[6]),this.h()},l(l){e=u(l,"P",{class:!0});var a=v(e);t=A(a,n[6]),a.forEach(f),this.h()},h(){c(e,"class","mt-1 text-sm text-red-600")},m(l,a){te(l,e,a),s(e,t)},p(l,a){a&64&&Ce(t,l[6])},d(l){l&&f(e)}}}function en(n){let e,t=n[0]?"Update License":"Issue License",l;return{c(){e=d("span"),l=U(t)},l(a){e=u(a,"SPAN",{});var r=v(e);l=A(r,t),r.forEach(f)},m(a,r){te(a,e,r),s(e,l)},p(a,r){r&1&&t!==(t=a[0]?"Update License":"Issue License")&&Ce(l,t)},i:gt,o:gt,d(a){a&&f(e)}}}function tn(n){let e,t,l,a=n[0]?"Updating...":"Issuing...",r,i;return e=new zl({props:{size:16,class:"animate-spin"}}),{c(){Pe(e.$$.fragment),t=T(),l=d("span"),r=U(a)},l(o){Oe(e.$$.fragment,o),t=E(o),l=u(o,"SPAN",{});var h=v(l);r=A(h,a),h.forEach(f)},m(o,h){Se(e,o,h),te(o,t,h),te(o,l,h),s(l,r),i=!0},p(o,h){(!i||h&1)&&a!==(a=o[0]?"Updating...":"Issuing...")&&Ce(r,a)},i(o){i||(ne(e.$$.fragment,o),i=!0)},o(o){ue(e.$$.fragment,o),i=!1},d(o){o&&(f(t),f(l)),Ne(e,o)}}}function ln(n){let e,t,l,a="Tenant",r,i,o,h="Select a tenant",y,_,b,p,k,D=n[0]?"Tenant cannot be changed in edit mode":"The tenant this license will be issued to",B,H,N,S,X="Issue Date & Time",q,F,C,g,L="When the license becomes active",O,R,$,Q="Validity Days",de,ee,se,ae,Ve="Number of days the license will be valid",ve,G,oe,K="License Template (Optional)",M,J,pe,Ee="Custom Payload",De,_e,Le="Choose a template to pre-fill the license payload",ie,ce,x,P,be,he="License Payload (JSON)",Me,Y,Re="Format JSON",w,re,ye,tt,Ie,_t="Custom data associated with this license (JSON format)",lt,Be,Ge,vt,je,Fe,$e,Ae,Ke,it,bt,nt=ot(n[1].filter(ul)),me=[];for(let I=0;I<nt.length;I+=1)me[I]=sl(nl(n,nt,I));let Te=n[5].tenant_id&&al(n),st=ot(n[2].filter(dl)),we=[];for(let I=0;I<st.length;I+=1)we[I]=rl(ll(n,st,I));let xe=n[3].template_id&&ol(n),fe=n[6]&&il(n);const Et=[tn,en],Ye=[];function Qe(I,j){return I[4]?0:1}return $e=Qe(n),Ae=Ye[$e]=Et[$e](n),{c(){e=d("form"),t=d("div"),l=d("label"),l.textContent=a,r=T(),i=d("select"),o=d("option"),o.textContent=h;for(let I=0;I<me.length;I+=1)me[I].c();b=T(),Te&&Te.c(),p=T(),k=d("p"),B=U(D),H=T(),N=d("div"),S=d("label"),S.textContent=X,q=T(),F=d("input"),C=T(),g=d("p"),g.textContent=L,O=T(),R=d("div"),$=d("label"),$.textContent=Q,de=T(),ee=d("input"),se=T(),ae=d("p"),ae.textContent=Ve,ve=T(),G=d("div"),oe=d("label"),oe.textContent=K,M=T(),J=d("select"),pe=d("option"),pe.textContent=Ee;for(let I=0;I<we.length;I+=1)we[I].c();De=T(),_e=d("p"),_e.textContent=Le,ie=T(),xe&&xe.c(),ce=T(),x=d("div"),P=d("div"),be=d("label"),be.textContent=he,Me=T(),Y=d("button"),Y.textContent=Re,w=T(),re=d("textarea"),ye=T(),fe&&fe.c(),tt=T(),Ie=d("p"),Ie.textContent=_t,lt=T(),Be=d("div"),Ge=d("button"),vt=U("Cancel"),je=T(),Fe=d("button"),Ae.c(),this.h()},l(I){e=u(I,"FORM",{class:!0});var j=v(e);t=u(j,"DIV",{});var W=v(t);l=u(W,"LABEL",{for:!0,class:!0,"data-svelte-h":!0}),z(l)!=="svelte-owcam6"&&(l.textContent=a),r=E(W),i=u(W,"SELECT",{id:!0,class:!0});var Z=v(i);o=u(Z,"OPTION",{"data-svelte-h":!0}),z(o)!=="svelte-1n5ox7x"&&(o.textContent=h);for(let rt=0;rt<me.length;rt+=1)me[rt].l(Z);Z.forEach(f),b=E(W),Te&&Te.l(W),p=E(W),k=u(W,"P",{class:!0});var Ze=v(k);B=A(Ze,D),Ze.forEach(f),W.forEach(f),H=E(j),N=u(j,"DIV",{});var ze=v(N);S=u(ze,"LABEL",{for:!0,class:!0,"data-svelte-h":!0}),z(S)!=="svelte-1k6akxv"&&(S.textContent=X),q=E(ze),F=u(ze,"INPUT",{type:!0,id:!0,class:!0}),C=E(ze),g=u(ze,"P",{class:!0,"data-svelte-h":!0}),z(g)!=="svelte-18thjpp"&&(g.textContent=L),ze.forEach(f),O=E(j),R=u(j,"DIV",{});var at=v(R);$=u(at,"LABEL",{for:!0,class:!0,"data-svelte-h":!0}),z($)!=="svelte-15ffnsh"&&($.textContent=Q),de=E(at),ee=u(at,"INPUT",{type:!0,id:!0,class:!0,min:!0}),se=E(at),ae=u(at,"P",{class:!0,"data-svelte-h":!0}),z(ae)!=="svelte-1g1yn1f"&&(ae.textContent=Ve),at.forEach(f),ve=E(j),G=u(j,"DIV",{});var Ue=v(G);oe=u(Ue,"LABEL",{for:!0,class:!0,"data-svelte-h":!0}),z(oe)!=="svelte-1lp05z2"&&(oe.textContent=K),M=E(Ue),J=u(Ue,"SELECT",{id:!0,class:!0});var yt=v(J);pe=u(yt,"OPTION",{"data-svelte-h":!0}),z(pe)!=="svelte-g1rl2t"&&(pe.textContent=Ee);for(let rt=0;rt<we.length;rt+=1)we[rt].l(yt);yt.forEach(f),De=E(Ue),_e=u(Ue,"P",{class:!0,"data-svelte-h":!0}),z(_e)!=="svelte-1nplag9"&&(_e.textContent=Le),ie=E(Ue),xe&&xe.l(Ue),Ue.forEach(f),ce=E(j),x=u(j,"DIV",{});var We=v(x);P=u(We,"DIV",{class:!0});var Xe=v(P);be=u(Xe,"LABEL",{for:!0,class:!0,"data-svelte-h":!0}),z(be)!=="svelte-uuuejq"&&(be.textContent=he),Me=E(Xe),Y=u(Xe,"BUTTON",{type:!0,class:!0,"data-svelte-h":!0}),z(Y)!=="svelte-9633ie"&&(Y.textContent=Re),Xe.forEach(f),w=E(We),re=u(We,"TEXTAREA",{id:!0,class:!0,placeholder:!0,rows:!0}),v(re).forEach(f),ye=E(We),fe&&fe.l(We),tt=E(We),Ie=u(We,"P",{class:!0,"data-svelte-h":!0}),z(Ie)!=="svelte-184mca7"&&(Ie.textContent=_t),We.forEach(f),lt=E(j),Be=u(j,"DIV",{class:!0});var ke=v(Be);Ge=u(ke,"BUTTON",{type:!0,class:!0});var wt=v(Ge);vt=A(wt,"Cancel"),wt.forEach(f),je=E(ke),Fe=u(ke,"BUTTON",{type:!0,class:!0});var et=v(Fe);Ae.l(et),et.forEach(f),ke.forEach(f),j.forEach(f),this.h()},h(){c(l,"for","tenant_id"),c(l,"class","form-label"),o.__value="",ge(o,o.__value),c(i,"id","tenant_id"),c(i,"class",y="form-input "+(n[0]?"bg-gray-100 dark:bg-gray-700 cursor-not-allowed":"")),i.disabled=_=!!n[0],i.required=!0,n[3].tenant_id===void 0&&At(()=>n[11].call(i)),c(k,"class","mt-1 text-sm text-gray-500 dark:text-gray-400"),c(S,"for","issued_at"),c(S,"class","form-label"),c(F,"type","datetime-local"),c(F,"id","issued_at"),c(F,"class","form-input"),F.required=!0,c(g,"class","mt-1 text-sm text-gray-500 dark:text-gray-400"),c($,"for","validity_days"),c($,"class","form-label"),c(ee,"type","number"),c(ee,"id","validity_days"),c(ee,"class","form-input"),c(ee,"min","1"),ee.required=!0,c(ae,"class","mt-1 text-sm text-gray-500 dark:text-gray-400"),c(oe,"for","template_id"),c(oe,"class","form-label"),pe.__value="",ge(pe,pe.__value),c(J,"id","template_id"),c(J,"class","form-input"),n[3].template_id===void 0&&At(()=>n[14].call(J)),c(_e,"class","mt-1 text-sm text-gray-500 dark:text-gray-400"),c(be,"for","payload"),c(be,"class","form-label"),c(Y,"type","button"),c(Y,"class","text-xs bg-gray-100 dark:bg-gray-800 text-gray-600 dark:text-gray-400 px-2 py-1 rounded hover:bg-gray-200 dark:hover:bg-gray-700"),c(P,"class","flex items-center justify-between mb-2"),c(re,"id","payload"),c(re,"class","form-input font-mono text-sm"),c(re,"placeholder","Enter custom license payload data..."),c(re,"rows","8"),c(Ie,"class","mt-1 text-sm text-gray-500 dark:text-gray-400"),c(Ge,"type","button"),c(Ge,"class","btn btn-secondary"),Ge.disabled=n[4],c(Fe,"type","submit"),c(Fe,"class","btn btn-primary flex items-center space-x-2"),Fe.disabled=n[4],c(Be,"class","flex justify-end space-x-3 pt-4 border-t border-gray-200 dark:border-gray-700"),c(e,"class","space-y-6")},m(I,j){te(I,e,j),s(e,t),s(t,l),s(t,r),s(t,i),s(i,o);for(let W=0;W<me.length;W+=1)me[W]&&me[W].m(i,null);mt(i,n[3].tenant_id,!0),s(t,b),Te&&Te.m(t,null),s(t,p),s(t,k),s(k,B),s(e,H),s(e,N),s(N,S),s(N,q),s(N,F),ge(F,n[3].issued_at),s(N,C),s(N,g),s(e,O),s(e,R),s(R,$),s(R,de),s(R,ee),ge(ee,n[3].validity_days),s(R,se),s(R,ae),s(e,ve),s(e,G),s(G,oe),s(G,M),s(G,J),s(J,pe);for(let W=0;W<we.length;W+=1)we[W]&&we[W].m(J,null);mt(J,n[3].template_id,!0),s(G,De),s(G,_e),s(G,ie),xe&&xe.m(G,null),s(e,ce),s(e,x),s(x,P),s(P,be),s(P,Me),s(P,Y),s(x,w),s(x,re),ge(re,n[3].payload),s(x,ye),fe&&fe.m(x,null),s(x,tt),s(x,Ie),s(e,lt),s(e,Be),s(Be,Ge),s(Ge,vt),s(Be,je),s(Be,Fe),Ye[$e].m(Fe,null),Ke=!0,it||(bt=[le(i,"change",n[11]),le(F,"input",n[12]),le(ee,"input",n[13]),le(J,"change",n[14]),le(J,"change",n[7]),le(Y,"click",n[10]),le(re,"input",n[16]),le(Ge,"click",n[9]),le(e,"submit",Vl(n[8]))],it=!0)},p(I,[j]){if(j&2){nt=ot(I[1].filter(ul));let Z;for(Z=0;Z<nt.length;Z+=1){const Ze=nl(I,nt,Z);me[Z]?me[Z].p(Ze,j):(me[Z]=sl(Ze),me[Z].c(),me[Z].m(i,null))}for(;Z<me.length;Z+=1)me[Z].d(1);me.length=nt.length}if((!Ke||j&1&&y!==(y="form-input "+(I[0]?"bg-gray-100 dark:bg-gray-700 cursor-not-allowed":"")))&&c(i,"class",y),(!Ke||j&1&&_!==(_=!!I[0]))&&(i.disabled=_),j&10&&mt(i,I[3].tenant_id),I[5].tenant_id?Te?Te.p(I,j):(Te=al(I),Te.c(),Te.m(t,p)):Te&&(Te.d(1),Te=null),(!Ke||j&1)&&D!==(D=I[0]?"Tenant cannot be changed in edit mode":"The tenant this license will be issued to")&&Ce(B,D),j&10&&ge(F,I[3].issued_at),j&10&&El(ee.value)!==I[3].validity_days&&ge(ee,I[3].validity_days),j&4){st=ot(I[2].filter(dl));let Z;for(Z=0;Z<st.length;Z+=1){const Ze=ll(I,st,Z);we[Z]?we[Z].p(Ze,j):(we[Z]=rl(Ze),we[Z].c(),we[Z].m(J,null))}for(;Z<we.length;Z+=1)we[Z].d(1);we.length=st.length}j&10&&mt(J,I[3].template_id),I[3].template_id?xe?xe.p(I,j):(xe=ol(I),xe.c(),xe.m(G,null)):xe&&(xe.d(1),xe=null),j&10&&ge(re,I[3].payload),I[6]?fe?fe.p(I,j):(fe=il(I),fe.c(),fe.m(x,tt)):fe&&(fe.d(1),fe=null),(!Ke||j&16)&&(Ge.disabled=I[4]);let W=$e;$e=Qe(I),$e===W?Ye[$e].p(I,j):(Bt(),ue(Ye[W],1,1,()=>{Ye[W]=null}),jt(),Ae=Ye[$e],Ae?Ae.p(I,j):(Ae=Ye[$e]=Et[$e](I),Ae.c()),ne(Ae,1),Ae.m(Fe,null)),(!Ke||j&16)&&(Fe.disabled=I[4])},i(I){Ke||(ne(Ae),Ke=!0)},o(I){ue(Ae),Ke=!1},d(I){I&&f(e),It(me,I),Te&&Te.d(),It(we,I),xe&&xe.d(),fe&&fe.d(),Ye[$e].d(),it=!1,Lt(bt)}}}function cl(n){const e=new Date(n),t=e.getFullYear(),l=String(e.getMonth()+1).padStart(2,"0"),a=String(e.getDate()).padStart(2,"0"),r=String(e.getHours()).padStart(2,"0"),i=String(e.getMinutes()).padStart(2,"0");return`${t}-${l}-${a}T${r}:${i}`}const ul=n=>n.is_active,dl=n=>n.is_active;function nn(n,e,t){let{license:l=null}=e,{tenants:a=[]}=e,{templates:r=[]}=e;const i=Ml();let o={tenant_id:(l==null?void 0:l.tenant_id)||"",template_id:(l==null?void 0:l.template_id)||"",issued_at:l!=null&&l.issued_at?cl(l.issued_at):cl(new Date().toISOString()),validity_days:(l==null?void 0:l.validity_days)||30,payload:l!=null&&l.payload?JSON.stringify(l.payload,null,2):"{}"},h=!1,y={},_="";function b(C){const L=C.target.value;console.log("Template changed to:",L),console.log("Templates available:",r.map(O=>({id:O.id,name:O.name}))),t(3,o.template_id=L,o),L&&!l?p(L):!L&&!l&&t(3,o.payload="{}",o)}function p(C){try{const g=r.find(L=>L.id===C);console.log("Found template:",g),g&&g.payload_schema?(t(3,o.payload=JSON.stringify(g.payload_schema,null,2),o),t(6,_=""),console.log("Loaded template payload for:",g.name)):(t(3,o.payload="{}",o),console.log("No payload schema found, using empty object"))}catch(g){console.error("Error loading template payload:",g),t(3,o.payload="{}",o)}}async function k(){if(t(5,y={}),t(6,_=""),!o.tenant_id){t(5,y.tenant_id="Tenant is required",y);return}let C;try{o.payload.trim()?C=JSON.parse(o.payload):C={}}catch{t(6,_="Invalid JSON in payload");return}try{t(4,h=!0);const g={tenant_id:o.tenant_id,template_id:o.template_id||void 0,issued_at:new Date(o.issued_at).toISOString().replace(/\.\d{3}Z$/,"Z"),validity_days:parseInt(o.validity_days.toString()),payload:C||{}};console.log("Submitting license data:",g),l?(await Dt.updateLicense(l.id,g),ft.success("License updated successfully")):(await Dt.createLicense(g),ft.success("License created successfully")),i("success")}catch(g){console.error("Form submission error:",g),g.message?g.message.includes("HTTP")||g.message.includes("detail")?ft.error(g.message):ft.error("An error occurred while saving the license: "+g.message):ft.error("An error occurred while saving the license")}finally{t(4,h=!1)}}function D(){i("cancel")}function B(){try{if(o.payload.trim()){const C=JSON.parse(o.payload);t(3,o.payload=JSON.stringify(C,null,2),o),t(6,_="")}}catch{t(6,_="Invalid JSON format")}}function H(){o.tenant_id=Ut(this),t(3,o),t(1,a)}function N(){o.issued_at=this.value,t(3,o),t(1,a)}function S(){o.validity_days=El(this.value),t(3,o),t(1,a)}function X(){o.template_id=Ut(this),t(3,o),t(1,a)}const q=C=>C.id===o.template_id;function F(){o.payload=this.value,t(3,o),t(1,a)}return n.$$set=C=>{"license"in C&&t(0,l=C.license),"tenants"in C&&t(1,a=C.tenants),"templates"in C&&t(2,r=C.templates)},n.$$.update=()=>{if(n.$$.dirty&13&&o.template_id&&r.length>0){const C=r.find(g=>g.id===o.template_id);C&&!l&&console.log("Reactive: Template selected",C.name)}},[l,a,r,o,h,y,_,b,k,D,B,H,N,S,X,q,F]}class xl extends Ft{constructor(e){super(),Rt(this,e,nn,ln,Jt,{license:0,tenants:1,templates:2})}}function fl(n,e,t){const l=n.slice();l[51]=e[t],l[54]=t;const a=Math.max(1,Math.min(l[6]-4,l[5]-2))+l[54];return l[52]=a,l}function _l(n,e,t){const l=n.slice();return l[55]=e[t],l}function hl(n,e,t){const l=n.slice();return l[58]=e[t],l}function pl(n){let e,t=n[58].name+"",l,a;return{c(){e=d("option"),l=U(t),this.h()},l(r){e=u(r,"OPTION",{});var i=v(e);l=A(i,t),i.forEach(f),this.h()},h(){e.__value=a=n[58].id,ge(e,e.__value)},m(r,i){te(r,e,i),s(e,l)},p(r,i){i[0]&8192&&t!==(t=r[58].name+"")&&Ce(l,t),i[0]&8192&&a!==(a=r[58].id)&&(e.__value=a,ge(e,e.__value))},d(r){r&&f(e)}}}function sn(n){let e,t,l='<tr><th>License ID</th> <th>Tenant</th> <th>Issued</th> <th>Validity Days</th> <th>Status</th> <th class="text-right">Actions</th></tr>',a,r,i,o=ot(n[15]()),h=[];for(let _=0;_<o.length;_+=1)h[_]=ml(_l(n,o,_));const y=_=>ue(h[_],1,1,()=>{h[_]=null});return{c(){e=d("table"),t=d("thead"),t.innerHTML=l,a=T(),r=d("tbody");for(let _=0;_<h.length;_+=1)h[_].c();this.h()},l(_){e=u(_,"TABLE",{class:!0});var b=v(e);t=u(b,"THEAD",{"data-svelte-h":!0}),z(t)!=="svelte-10lw9gt"&&(t.innerHTML=l),a=E(b),r=u(b,"TBODY",{});var p=v(r);for(let k=0;k<h.length;k+=1)h[k].l(p);p.forEach(f),b.forEach(f),this.h()},h(){c(e,"class","table")},m(_,b){te(_,e,b),s(e,t),s(e,a),s(e,r);for(let p=0;p<h.length;p+=1)h[p]&&h[p].m(r,null);i=!0},p(_,b){if(b[0]&1998848){o=ot(_[15]());let p;for(p=0;p<o.length;p+=1){const k=_l(_,o,p);h[p]?(h[p].p(k,b),ne(h[p],1)):(h[p]=ml(k),h[p].c(),ne(h[p],1),h[p].m(r,null))}for(Bt(),p=o.length;p<h.length;p+=1)y(p);jt()}},i(_){if(!i){for(let b=0;b<o.length;b+=1)ne(h[b]);i=!0}},o(_){h=h.filter(Boolean);for(let b=0;b<h.length;b+=1)ue(h[b]);i=!1},d(_){_&&f(e),It(h,_)}}}function an(n){let e,t,l,a,r="No licenses found",i,o,h=n[3]||n[4]?"Try adjusting your filters.":"Get started by issuing your first license.",y,_,b;t=new Jl({props:{class:"mx-auto text-gray-400 mb-4",size:48}});let p=!n[3]&&!n[4]&&gl(n);return{c(){e=d("div"),Pe(t.$$.fragment),l=T(),a=d("h3"),a.textContent=r,i=T(),o=d("p"),y=U(h),_=T(),p&&p.c(),this.h()},l(k){e=u(k,"DIV",{class:!0});var D=v(e);Oe(t.$$.fragment,D),l=E(D),a=u(D,"H3",{class:!0,"data-svelte-h":!0}),z(a)!=="svelte-1k3e4uy"&&(a.textContent=r),i=E(D),o=u(D,"P",{class:!0});var B=v(o);y=A(B,h),B.forEach(f),_=E(D),p&&p.l(D),D.forEach(f),this.h()},h(){c(a,"class","text-lg font-medium text-gray-900 dark:text-gray-50 mb-2"),c(o,"class","text-gray-600 dark:text-gray-400 mb-4"),c(e,"class","text-center py-12")},m(k,D){te(k,e,D),Se(t,e,null),s(e,l),s(e,a),s(e,i),s(e,o),s(o,y),s(e,_),p&&p.m(e,null),b=!0},p(k,D){(!b||D[0]&24)&&h!==(h=k[3]||k[4]?"Try adjusting your filters.":"Get started by issuing your first license.")&&Ce(y,h),!k[3]&&!k[4]?p?(p.p(k,D),D[0]&24&&ne(p,1)):(p=gl(k),p.c(),ne(p,1),p.m(e,null)):p&&(Bt(),ue(p,1,1,()=>{p=null}),jt())},i(k){b||(ne(t.$$.fragment,k),ne(p),b=!0)},o(k){ue(t.$$.fragment,k),ue(p),b=!1},d(k){k&&f(e),Ne(t),p&&p.d()}}}function rn(n){let e,t='<div class="spinner mr-3"></div> <span class="text-gray-600 dark:text-gray-400">Loading licenses...</span>';return{c(){e=d("div"),e.innerHTML=t,this.h()},l(l){e=u(l,"DIV",{class:!0,"data-svelte-h":!0}),z(e)!=="svelte-msv725"&&(e.innerHTML=t),this.h()},h(){c(e,"class","flex items-center justify-center py-12")},m(l,a){te(l,e,a)},p:gt,i:gt,o:gt,d(l){l&&f(e)}}}function ml(n){let e,t,l=n[55].id.toString().substring(0,8)+"",a,r,i,o=n[55].tenant_name+"",h,y,_,b,p,k,D,B=new Date(n[55].issued_at).toLocaleDateString()+"",H,N,S,X=n[55].validity_days+"",q,F,C,g,L='<span class="inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium bg-green-100 text-green-800 dark:bg-green-900/20 dark:text-green-400">Active</span>',O,R,$,Q,de,ee,se,ae,Ve,ve,G,oe,K,M,J,pe,Ee,De;p=new Xl({props:{size:14}}),de=new Kl({props:{size:16}});function _e(){return n[27](n[55])}ae=new Yl({props:{size:16}});function Le(){return n[28](n[55])}G=new ql({props:{size:16}});function ie(){return n[29](n[55])}M=new wl({props:{size:16}});function ce(){return n[30](n[55])}return{c(){e=d("tr"),t=d("td"),a=U(l),r=T(),i=d("td"),h=U(o),y=T(),_=d("td"),b=d("div"),Pe(p.$$.fragment),k=T(),D=d("span"),H=U(B),N=T(),S=d("td"),q=U(X),F=U(" days"),C=T(),g=d("td"),g.innerHTML=L,O=T(),R=d("td"),$=d("div"),Q=d("button"),Pe(de.$$.fragment),ee=T(),se=d("button"),Pe(ae.$$.fragment),Ve=T(),ve=d("button"),Pe(G.$$.fragment),oe=T(),K=d("button"),Pe(M.$$.fragment),J=T(),this.h()},l(x){e=u(x,"TR",{class:!0});var P=v(e);t=u(P,"TD",{class:!0});var be=v(t);a=A(be,l),be.forEach(f),r=E(P),i=u(P,"TD",{class:!0});var he=v(i);h=A(he,o),he.forEach(f),y=E(P),_=u(P,"TD",{class:!0});var Me=v(_);b=u(Me,"DIV",{class:!0});var Y=v(b);Oe(p.$$.fragment,Y),k=E(Y),D=u(Y,"SPAN",{});var Re=v(D);H=A(Re,B),Re.forEach(f),Y.forEach(f),Me.forEach(f),N=E(P),S=u(P,"TD",{class:!0});var w=v(S);q=A(w,X),F=A(w," days"),w.forEach(f),C=E(P),g=u(P,"TD",{"data-svelte-h":!0}),z(g)!=="svelte-aeybo8"&&(g.innerHTML=L),O=E(P),R=u(P,"TD",{class:!0});var re=v(R);$=u(re,"DIV",{class:!0});var ye=v($);Q=u(ye,"BUTTON",{class:!0,title:!0});var tt=v(Q);Oe(de.$$.fragment,tt),tt.forEach(f),ee=E(ye),se=u(ye,"BUTTON",{class:!0,title:!0});var Ie=v(se);Oe(ae.$$.fragment,Ie),Ie.forEach(f),Ve=E(ye),ve=u(ye,"BUTTON",{class:!0,title:!0});var _t=v(ve);Oe(G.$$.fragment,_t),_t.forEach(f),oe=E(ye),K=u(ye,"BUTTON",{class:!0,title:!0});var lt=v(K);Oe(M.$$.fragment,lt),lt.forEach(f),ye.forEach(f),re.forEach(f),J=E(P),P.forEach(f),this.h()},h(){c(t,"class","font-mono text-sm font-medium text-gray-900 dark:text-gray-50"),c(i,"class","text-gray-600 dark:text-gray-400"),c(b,"class","flex items-center space-x-1"),c(_,"class","text-gray-600 dark:text-gray-400"),c(S,"class","text-gray-600 dark:text-gray-400"),c(Q,"class","p-1 text-gray-400 hover:text-blue-500 rounded"),c(Q,"title","View license details"),c(se,"class","p-1 text-gray-400 hover:text-green-500 rounded"),c(se,"title","Download license file"),c(ve,"class","p-1 text-gray-400 hover:text-blue-500 rounded"),c(ve,"title","Edit license"),c(K,"class","p-1 text-gray-400 hover:text-red-500 rounded"),c(K,"title","Revoke license"),c($,"class","flex items-center justify-end space-x-2"),c(R,"class","text-right"),c(e,"class","hover:bg-gray-50 dark:hover:bg-gray-800")},m(x,P){te(x,e,P),s(e,t),s(t,a),s(e,r),s(e,i),s(i,h),s(e,y),s(e,_),s(_,b),Se(p,b,null),s(b,k),s(b,D),s(D,H),s(e,N),s(e,S),s(S,q),s(S,F),s(e,C),s(e,g),s(e,O),s(e,R),s(R,$),s($,Q),Se(de,Q,null),s($,ee),s($,se),Se(ae,se,null),s($,Ve),s($,ve),Se(G,ve,null),s($,oe),s($,K),Se(M,K,null),s(e,J),pe=!0,Ee||(De=[le(Q,"click",_e),le(se,"click",Le),le(ve,"click",ie),le(K,"click",ce)],Ee=!0)},p(x,P){n=x},i(x){pe||(ne(p.$$.fragment,x),ne(de.$$.fragment,x),ne(ae.$$.fragment,x),ne(G.$$.fragment,x),ne(M.$$.fragment,x),pe=!0)},o(x){ue(p.$$.fragment,x),ue(de.$$.fragment,x),ue(ae.$$.fragment,x),ue(G.$$.fragment,x),ue(M.$$.fragment,x),pe=!1},d(x){x&&f(e),Ne(p),Ne(de),Ne(ae),Ne(G),Ne(M),Ee=!1,Lt(De)}}}function gl(n){let e,t,l,a,r="Create License",i,o,h;return t=new Tl({props:{size:18}}),{c(){e=d("button"),Pe(t.$$.fragment),l=T(),a=d("span"),a.textContent=r,this.h()},l(y){e=u(y,"BUTTON",{class:!0});var _=v(e);Oe(t.$$.fragment,_),l=E(_),a=u(_,"SPAN",{"data-svelte-h":!0}),z(a)!=="svelte-u0mxhl"&&(a.textContent=r),_.forEach(f),this.h()},h(){c(e,"class","btn btn-primary flex items-center space-x-2 mx-auto")},m(y,_){te(y,e,_),Se(t,e,null),s(e,l),s(e,a),i=!0,o||(h=le(e,"click",n[16]),o=!0)},p:gt,i(y){i||(ne(t.$$.fragment,y),i=!0)},o(y){ue(t.$$.fragment,y),i=!1},d(y){y&&f(e),Ne(t),o=!1,h()}}}function vl(n){let e,t,l,a,r,i,o,h,y,_,b,p,k,D,B,H,N,S,X,q,F=ot(Array(Math.min(5,n[6]))),C=[];for(let g=0;g<F.length;g+=1)C[g]=yl(fl(n,F,g));return{c(){e=d("div"),t=d("button"),l=U("««"),r=T(),i=d("button"),o=U("‹"),y=T(),_=d("div");for(let g=0;g<C.length;g+=1)C[g].c();b=T(),p=d("button"),k=U("›"),B=T(),H=d("button"),N=U("»»"),this.h()},l(g){e=u(g,"DIV",{class:!0});var L=v(e);t=u(L,"BUTTON",{class:!0,title:!0});var O=v(t);l=A(O,"««"),O.forEach(f),r=E(L),i=u(L,"BUTTON",{class:!0,title:!0});var R=v(i);o=A(R,"‹"),R.forEach(f),y=E(L),_=u(L,"DIV",{class:!0});var $=v(_);for(let ee=0;ee<C.length;ee+=1)C[ee].l($);$.forEach(f),b=E(L),p=u(L,"BUTTON",{class:!0,title:!0});var Q=v(p);k=A(Q,"›"),Q.forEach(f),B=E(L),H=u(L,"BUTTON",{class:!0,title:!0});var de=v(H);N=A(de,"»»"),de.forEach(f),L.forEach(f),this.h()},h(){c(t,"class","btn btn-secondary"),t.disabled=a=n[5]===1,c(t,"title","First page"),c(i,"class","btn btn-secondary"),i.disabled=h=n[5]===1,c(i,"title","Previous page"),c(_,"class","flex items-center space-x-1"),c(p,"class","btn btn-secondary"),p.disabled=D=n[5]===n[6],c(p,"title","Next page"),c(H,"class","btn btn-secondary"),H.disabled=S=n[5]===n[6],c(H,"title","Last page"),c(e,"class","flex items-center space-x-2")},m(g,L){te(g,e,L),s(e,t),s(t,l),s(e,r),s(e,i),s(i,o),s(e,y),s(e,_);for(let O=0;O<C.length;O+=1)C[O]&&C[O].m(_,null);s(e,b),s(e,p),s(p,k),s(e,B),s(e,H),s(H,N),X||(q=[le(t,"click",n[33]),le(i,"click",n[34]),le(p,"click",n[36]),le(H,"click",n[37])],X=!0)},p(g,L){if(L[0]&32&&a!==(a=g[5]===1)&&(t.disabled=a),L[0]&32&&h!==(h=g[5]===1)&&(i.disabled=h),L[0]&16480){F=ot(Array(Math.min(5,g[6])));let O;for(O=0;O<F.length;O+=1){const R=fl(g,F,O);C[O]?C[O].p(R,L):(C[O]=yl(R),C[O].c(),C[O].m(_,null))}for(;O<C.length;O+=1)C[O].d(1);C.length=F.length}L[0]&96&&D!==(D=g[5]===g[6])&&(p.disabled=D),L[0]&96&&S!==(S=g[5]===g[6])&&(H.disabled=S)},d(g){g&&f(e),It(C,g),X=!1,Lt(q)}}}function bl(n){let e,t=n[52]+"",l,a,r,i,o;function h(){return n[35](n[52])}return{c(){e=d("button"),l=U(t),a=T(),this.h()},l(y){e=u(y,"BUTTON",{class:!0});var _=v(e);l=A(_,t),a=E(_),_.forEach(f),this.h()},h(){c(e,"class",r="px-3 py-2 text-sm font-medium rounded-lg border transition-colors "+(n[52]===n[5]?"bg-blue-500 text-white border-blue-500 shadow-sm":"bg-white dark:bg-gray-800 text-gray-700 dark:text-gray-300 border-gray-300 dark:border-gray-600 hover:bg-gray-50 dark:hover:bg-gray-700"))},m(y,_){te(y,e,_),s(e,l),s(e,a),i||(o=le(e,"click",h),i=!0)},p(y,_){n=y,_[0]&96&&t!==(t=n[52]+"")&&Ce(l,t),_[0]&96&&r!==(r="px-3 py-2 text-sm font-medium rounded-lg border transition-colors "+(n[52]===n[5]?"bg-blue-500 text-white border-blue-500 shadow-sm":"bg-white dark:bg-gray-800 text-gray-700 dark:text-gray-300 border-gray-300 dark:border-gray-600 hover:bg-gray-50 dark:hover:bg-gray-700"))&&c(e,"class",r)},d(y){y&&f(e),i=!1,o()}}}function yl(n){let e,t=n[52]<=n[6]&&bl(n);return{c(){t&&t.c(),e=tl()},l(l){t&&t.l(l),e=tl()},m(l,a){t&&t.m(l,a),te(l,e,a)},p(l,a){l[52]<=l[6]?t?t.p(l,a):(t=bl(l),t.c(),t.m(e.parentNode,e)):t&&(t.d(1),t=null)},d(l){l&&f(e),t&&t.d(l)}}}function on(n){let e,t;return e=new xl({props:{tenants:n[13],templates:n[1]}}),e.$on("success",n[22]),e.$on("cancel",n[38]),{c(){Pe(e.$$.fragment)},l(l){Oe(e.$$.fragment,l)},m(l,a){Se(e,l,a),t=!0},p(l,a){const r={};a[0]&8192&&(r.tenants=l[13]),a[0]&2&&(r.templates=l[1]),e.$set(r)},i(l){t||(ne(e.$$.fragment,l),t=!0)},o(l){ue(e.$$.fragment,l),t=!1},d(l){Ne(e,l)}}}function cn(n){let e,t;return e=new xl({props:{license:n[12],tenants:n[13],templates:n[1]}}),e.$on("success",n[22]),e.$on("cancel",n[41]),{c(){Pe(e.$$.fragment)},l(l){Oe(e.$$.fragment,l)},m(l,a){Se(e,l,a),t=!0},p(l,a){const r={};a[0]&4096&&(r.license=l[12]),a[0]&8192&&(r.tenants=l[13]),a[0]&2&&(r.templates=l[1]),e.$set(r)},i(l){t||(ne(e.$$.fragment,l),t=!0)},o(l){ue(e.$$.fragment,l),t=!1},d(l){Ne(e,l)}}}function kl(n){let e,t,l="License Key",a,r,i,o=n[12].license_key+"",h,y,_,b="This key should be shared with the customer for offline license validation.";return{c(){e=d("div"),t=d("h3"),t.textContent=l,a=T(),r=d("div"),i=d("p"),h=U(o),y=T(),_=d("p"),_.textContent=b,this.h()},l(p){e=u(p,"DIV",{});var k=v(e);t=u(k,"H3",{class:!0,"data-svelte-h":!0}),z(t)!=="svelte-futyli"&&(t.textContent=l),a=E(k),r=u(k,"DIV",{class:!0});var D=v(r);i=u(D,"P",{class:!0});var B=v(i);h=A(B,o),B.forEach(f),D.forEach(f),y=E(k),_=u(k,"P",{class:!0,"data-svelte-h":!0}),z(_)!=="svelte-1ybej9y"&&(_.textContent=b),k.forEach(f),this.h()},h(){c(t,"class","text-lg font-medium text-gray-900 dark:text-gray-50 mb-3"),c(i,"class","text-sm font-mono text-gray-800 dark:text-gray-200 break-all"),c(r,"class","bg-gray-50 dark:bg-gray-800 rounded-lg p-4"),c(_,"class","mt-2 text-sm text-gray-600 dark:text-gray-400")},m(p,k){te(p,e,k),s(e,t),s(e,a),s(e,r),s(r,i),s(i,h),s(e,y),s(e,_)},p(p,k){k[0]&4096&&o!==(o=p[12].license_key+"")&&Ce(h,o)},d(p){p&&f(e)}}}function Cl(n){let e,t,l="License Payload",a,r,i,o,h=JSON.stringify(n[12].payload,null,2)+"",y;return{c(){e=d("div"),t=d("h3"),t.textContent=l,a=T(),r=d("div"),i=d("pre"),o=d("code"),y=U(h),this.h()},l(_){e=u(_,"DIV",{});var b=v(e);t=u(b,"H3",{class:!0,"data-svelte-h":!0}),z(t)!=="svelte-paju5n"&&(t.textContent=l),a=E(b),r=u(b,"DIV",{class:!0});var p=v(r);i=u(p,"PRE",{class:!0});var k=v(i);o=u(k,"CODE",{});var D=v(o);y=A(D,h),D.forEach(f),k.forEach(f),p.forEach(f),b.forEach(f),this.h()},h(){c(t,"class","text-lg font-medium text-gray-900 dark:text-gray-50 mb-3"),c(i,"class","text-sm text-gray-800 dark:text-gray-200 overflow-x-auto"),c(r,"class","bg-gray-50 dark:bg-gray-800 rounded-lg p-4")},m(_,b){te(_,e,b),s(e,t),s(e,a),s(e,r),s(r,i),s(i,o),s(o,y)},p(_,b){b[0]&4096&&h!==(h=JSON.stringify(_[12].payload,null,2)+"")&&Ce(y,h)},d(_){_&&f(e)}}}function un(n){var J,pe,Ee,De,_e,Le;let e,t,l,a,r="License ID",i,o,h=((J=n[12])==null?void 0:J.id)+"",y,_,b,p,k="Tenant",D,B,H=(((pe=n[12])==null?void 0:pe.tenant_name)||"Unknown")+"",N,S,X,q,F="Issued Date",C,g,L=new Date((Ee=n[12])==null?void 0:Ee.issued_at).toLocaleDateString()+"",O,R,$,Q,de="Validity Days",ee,se,ae=((De=n[12])==null?void 0:De.validity_days)+"",Ve,ve,G,oe,K=((_e=n[12])==null?void 0:_e.license_key)&&kl(n),M=((Le=n[12])==null?void 0:Le.payload)&&Cl(n);return{c(){e=d("div"),t=d("div"),l=d("div"),a=d("h3"),a.textContent=r,i=T(),o=d("p"),y=U(h),_=T(),b=d("div"),p=d("h3"),p.textContent=k,D=T(),B=d("p"),N=U(H),S=T(),X=d("div"),q=d("h3"),q.textContent=F,C=T(),g=d("p"),O=U(L),R=T(),$=d("div"),Q=d("h3"),Q.textContent=de,ee=T(),se=d("p"),Ve=U(ae),ve=U(" days"),G=T(),K&&K.c(),oe=T(),M&&M.c(),this.h()},l(ie){e=u(ie,"DIV",{class:!0});var ce=v(e);t=u(ce,"DIV",{class:!0});var x=v(t);l=u(x,"DIV",{});var P=v(l);a=u(P,"H3",{class:!0,"data-svelte-h":!0}),z(a)!=="svelte-an7y5t"&&(a.textContent=r),i=E(P),o=u(P,"P",{class:!0});var be=v(o);y=A(be,h),be.forEach(f),P.forEach(f),_=E(x),b=u(x,"DIV",{});var he=v(b);p=u(he,"H3",{class:!0,"data-svelte-h":!0}),z(p)!=="svelte-1pkqwx"&&(p.textContent=k),D=E(he),B=u(he,"P",{class:!0});var Me=v(B);N=A(Me,H),Me.forEach(f),he.forEach(f),S=E(x),X=u(x,"DIV",{});var Y=v(X);q=u(Y,"H3",{class:!0,"data-svelte-h":!0}),z(q)!=="svelte-1xk3ofk"&&(q.textContent=F),C=E(Y),g=u(Y,"P",{class:!0});var Re=v(g);O=A(Re,L),Re.forEach(f),Y.forEach(f),R=E(x),$=u(x,"DIV",{});var w=v($);Q=u(w,"H3",{class:!0,"data-svelte-h":!0}),z(Q)!=="svelte-demd6a"&&(Q.textContent=de),ee=E(w),se=u(w,"P",{class:!0});var re=v(se);Ve=A(re,ae),ve=A(re," days"),re.forEach(f),w.forEach(f),x.forEach(f),G=E(ce),K&&K.l(ce),oe=E(ce),M&&M.l(ce),ce.forEach(f),this.h()},h(){c(a,"class","text-sm font-medium text-gray-500 dark:text-gray-400"),c(o,"class","text-lg font-mono font-medium text-gray-900 dark:text-gray-50"),c(p,"class","text-sm font-medium text-gray-500 dark:text-gray-400"),c(B,"class","text-lg font-medium text-gray-900 dark:text-gray-50"),c(q,"class","text-sm font-medium text-gray-500 dark:text-gray-400"),c(g,"class","text-lg text-gray-900 dark:text-gray-50"),c(Q,"class","text-sm font-medium text-gray-500 dark:text-gray-400"),c(se,"class","text-lg text-gray-900 dark:text-gray-50"),c(t,"class","grid grid-cols-2 gap-4"),c(e,"class","space-y-6")},m(ie,ce){te(ie,e,ce),s(e,t),s(t,l),s(l,a),s(l,i),s(l,o),s(o,y),s(t,_),s(t,b),s(b,p),s(b,D),s(b,B),s(B,N),s(t,S),s(t,X),s(X,q),s(X,C),s(X,g),s(g,O),s(t,R),s(t,$),s($,Q),s($,ee),s($,se),s(se,Ve),s(se,ve),s(e,G),K&&K.m(e,null),s(e,oe),M&&M.m(e,null)},p(ie,ce){var x,P,be,he,Me,Y;ce[0]&4096&&h!==(h=((x=ie[12])==null?void 0:x.id)+"")&&Ce(y,h),ce[0]&4096&&H!==(H=(((P=ie[12])==null?void 0:P.tenant_name)||"Unknown")+"")&&Ce(N,H),ce[0]&4096&&L!==(L=new Date((be=ie[12])==null?void 0:be.issued_at).toLocaleDateString()+"")&&Ce(O,L),ce[0]&4096&&ae!==(ae=((he=ie[12])==null?void 0:he.validity_days)+"")&&Ce(Ve,ae),(Me=ie[12])!=null&&Me.license_key?K?K.p(ie,ce):(K=kl(ie),K.c(),K.m(e,oe)):K&&(K.d(1),K=null),(Y=ie[12])!=null&&Y.payload?M?M.p(ie,ce):(M=Cl(ie),M.c(),M.m(e,null)):M&&(M.d(1),M=null)},d(ie){ie&&f(e),K&&K.d(),M&&M.d()}}}function dn(n){let e,t,l="Close",a,r;return{c(){e=d("div"),t=d("button"),t.textContent=l,this.h()},l(i){e=u(i,"DIV",{slot:!0,class:!0});var o=v(e);t=u(o,"BUTTON",{class:!0,"data-svelte-h":!0}),z(t)!=="svelte-1x7qvl"&&(t.textContent=l),o.forEach(f),this.h()},h(){c(t,"class","btn btn-secondary"),c(e,"slot","footer"),c(e,"class","flex justify-end")},m(i,o){te(i,e,o),s(e,t),a||(r=le(t,"click",n[44]),a=!0)},p:gt,d(i){i&&f(e),a=!1,r()}}}function fn(n){var F;let e,t,l,a,r,i,o,h,y="Revoke License",_,b,p,k,D=((F=n[12])==null?void 0:F.id)+"",B,H,N,S,X='<p class="text-sm text-yellow-800 dark:text-yellow-200">The license will become invalid and the tenant will lose access to the associated features.</p>',q;return r=new wl({props:{class:"text-red-600",size:20}}),{c(){e=d("div"),t=d("div"),l=d("div"),a=d("div"),Pe(r.$$.fragment),i=T(),o=d("div"),h=d("h3"),h.textContent=y,_=T(),b=d("p"),p=U("Are you sure you want to revoke license "),k=d("strong"),B=U(D),H=U(`?\r
          This action cannot be undone.`),N=T(),S=d("div"),S.innerHTML=X,this.h()},l(C){e=u(C,"DIV",{class:!0});var g=v(e);t=u(g,"DIV",{class:!0});var L=v(t);l=u(L,"DIV",{class:!0});var O=v(l);a=u(O,"DIV",{class:!0});var R=v(a);Oe(r.$$.fragment,R),R.forEach(f),O.forEach(f),i=E(L),o=u(L,"DIV",{class:!0});var $=v(o);h=u($,"H3",{class:!0,"data-svelte-h":!0}),z(h)!=="svelte-sdlzxk"&&(h.textContent=y),_=E($),b=u($,"P",{class:!0});var Q=v(b);p=A(Q,"Are you sure you want to revoke license "),k=u(Q,"STRONG",{class:!0});var de=v(k);B=A(de,D),de.forEach(f),H=A(Q,`?\r
          This action cannot be undone.`),Q.forEach(f),N=E($),S=u($,"DIV",{class:!0,"data-svelte-h":!0}),z(S)!=="svelte-1nljqfg"&&(S.innerHTML=X),$.forEach(f),L.forEach(f),g.forEach(f),this.h()},h(){c(a,"class","w-10 h-10 bg-red-100 dark:bg-red-900/20 rounded-full flex items-center justify-center"),c(l,"class","flex-shrink-0"),c(h,"class","text-lg font-medium text-gray-900 dark:text-gray-50"),c(k,"class","font-mono"),c(b,"class","text-gray-600 dark:text-gray-400 mt-1"),c(S,"class","mt-3 p-3 bg-yellow-50 dark:bg-yellow-900/20 border border-yellow-200 dark:border-yellow-800 rounded-lg"),c(o,"class","flex-1"),c(t,"class","flex items-start space-x-3"),c(e,"class","space-y-4")},m(C,g){te(C,e,g),s(e,t),s(t,l),s(l,a),Se(r,a,null),s(t,i),s(t,o),s(o,h),s(o,_),s(o,b),s(b,p),s(b,k),s(k,B),s(b,H),s(o,N),s(o,S),q=!0},p(C,g){var L;(!q||g[0]&4096)&&D!==(D=((L=C[12])==null?void 0:L.id)+"")&&Ce(B,D)},i(C){q||(ne(r.$$.fragment,C),q=!0)},o(C){ue(r.$$.fragment,C),q=!1},d(C){C&&f(e),Ne(r)}}}function _n(n){let e,t,l="Cancel",a,r,i="Revoke License",o,h;return{c(){e=d("div"),t=d("button"),t.textContent=l,a=T(),r=d("button"),r.textContent=i,this.h()},l(y){e=u(y,"DIV",{slot:!0,class:!0});var _=v(e);t=u(_,"BUTTON",{class:!0,"data-svelte-h":!0}),z(t)!=="svelte-1k2458d"&&(t.textContent=l),a=E(_),r=u(_,"BUTTON",{class:!0,"data-svelte-h":!0}),z(r)!=="svelte-1pcwtqt"&&(r.textContent=i),_.forEach(f),this.h()},h(){c(t,"class","btn btn-secondary"),c(r,"class","btn btn-danger"),c(e,"slot","footer"),c(e,"class","flex justify-end space-x-3")},m(y,_){te(y,e,_),s(e,t),s(e,a),s(e,r),o||(h=[le(t,"click",n[47]),le(r,"click",n[21])],o=!0)},p:gt,d(y){y&&f(e),o=!1,Lt(h)}}}function hn(n){let e,t,l,a,r='<h1 class="text-3xl font-bold text-gray-900 dark:text-gray-50">Licenses</h1> <p class="text-gray-600 dark:text-gray-400 mt-2">Issue and manage license keys for your tenants</p>',i,o,h,y,_,b,p,k,D,B="Create License",H,N,S,X,q,F,C,g,L,O="All Tenants",R,$,Q=n[15]().length+"",de,ee,se=n[0].length+"",ae,Ve,ve,G,oe,K,M,J,pe,Ee,De,_e,Le,ie="Show:",ce,x,P,be="10",he,Me="20",Y,Re="50",w,re="100",ye,tt="150",Ie,_t="200",lt,Be,Ge="per page",vt,je,Fe,$e=Math.min((n[5]-1)*n[7]+1,n[0].length)+"",Ae,Ke,it=Math.min(n[5]*n[7],n[0].length)+"",bt,nt,me=n[0].length+"",Te,st,we,xe,fe,Et,Ye,Qe,I,j,W,Z,Ze,ze,at,Ue,yt,We;y=new Hl({props:{size:18}}),p=new Tl({props:{size:18}});let Xe=ot(n[13]),ke=[];for(let m=0;m<Xe.length;m+=1)ke[m]=pl(hl(n,Xe,m));const wt=[rn,an,sn],et=[];function rt(m,V){return m[2]?0:(K==null&&(K=m[15]().length===0),K?1:2)}M=rt(n),J=et[M]=wt[M](n);let He=n[6]>1&&vl(n);function Dl(m){n[40](m)}let Gt={title:"Create New License",size:"lg",onClose:n[39],$$slots:{default:[on]},$$scope:{ctx:n}};n[8]!==void 0&&(Gt.open=n[8]),fe=new Mt({props:Gt}),Ot.push(()=>Vt(fe,"open",Dl));function Il(m){n[43](m)}let Kt={title:"Edit License",size:"lg",onClose:n[42],$$slots:{default:[cn]},$$scope:{ctx:n}};n[9]!==void 0&&(Kt.open=n[9]),Qe=new Mt({props:Kt}),Ot.push(()=>Vt(Qe,"open",Il));function Ll(m){n[46](m)}let Yt={title:"License Details",size:"lg",onClose:n[45],$$slots:{footer:[dn],default:[un]},$$scope:{ctx:n}};n[11]!==void 0&&(Yt.open=n[11]),W=new Mt({props:Yt}),Ot.push(()=>Vt(W,"open",Ll));function $l(m){n[48](m)}let Zt={title:"Revoke License",size:"sm",$$slots:{footer:[_n],default:[fn]},$$scope:{ctx:n}};return n[10]!==void 0&&(Zt.open=n[10]),ze=new Mt({props:Zt}),Ot.push(()=>Vt(ze,"open",$l)),{c(){e=T(),t=d("div"),l=d("div"),a=d("div"),a.innerHTML=r,i=T(),o=d("div"),h=d("button"),Pe(y.$$.fragment),_=T(),b=d("button"),Pe(p.$$.fragment),k=T(),D=d("span"),D.textContent=B,H=T(),N=d("div"),S=d("div"),X=d("div"),q=d("input"),F=T(),C=d("div"),g=d("select"),L=d("option"),L.textContent=O;for(let m=0;m<ke.length;m+=1)ke[m].c();R=T(),$=d("div"),de=U(Q),ee=U(" of "),ae=U(se),Ve=U(" licenses"),ve=T(),G=d("div"),oe=d("div"),J.c(),pe=T(),Ee=d("div"),De=d("div"),_e=d("div"),Le=d("label"),Le.textContent=ie,ce=T(),x=d("select"),P=d("option"),P.textContent=be,he=d("option"),he.textContent=Me,Y=d("option"),Y.textContent=Re,w=d("option"),w.textContent=re,ye=d("option"),ye.textContent=tt,Ie=d("option"),Ie.textContent=_t,lt=T(),Be=d("span"),Be.textContent=Ge,vt=T(),je=d("div"),Fe=U("Showing "),Ae=U($e),Ke=U(" to "),bt=U(it),nt=U(" of "),Te=U(me),st=U(" licenses"),we=T(),He&&He.c(),xe=T(),Pe(fe.$$.fragment),Ye=T(),Pe(Qe.$$.fragment),j=T(),Pe(W.$$.fragment),Ze=T(),Pe(ze.$$.fragment),this.h()},l(m){Al("svelte-1ljts26",document.head).forEach(f),e=E(m),t=u(m,"DIV",{class:!0});var qe=v(t);l=u(qe,"DIV",{class:!0});var ct=v(l);a=u(ct,"DIV",{"data-svelte-h":!0}),z(a)!=="svelte-3ypmen"&&(a.innerHTML=r),i=E(ct),o=u(ct,"DIV",{class:!0});var ut=v(o);h=u(ut,"BUTTON",{class:!0,title:!0});var kt=v(h);Oe(y.$$.fragment,kt),kt.forEach(f),_=E(ut),b=u(ut,"BUTTON",{class:!0});var ht=v(b);Oe(p.$$.fragment,ht),k=E(ht),D=u(ht,"SPAN",{"data-svelte-h":!0}),z(D)!=="svelte-u0mxhl"&&(D.textContent=B),ht.forEach(f),ut.forEach(f),ct.forEach(f),H=E(qe),N=u(qe,"DIV",{class:!0});var Je=v(N);S=u(Je,"DIV",{class:!0});var dt=v(S);X=u(dt,"DIV",{class:!0});var Qt=v(X);q=u(Qt,"INPUT",{type:!0,placeholder:!0,class:!0}),Qt.forEach(f),F=E(dt),C=u(dt,"DIV",{class:!0});var Wt=v(C);g=u(Wt,"SELECT",{class:!0});var zt=v(g);L=u(zt,"OPTION",{"data-svelte-h":!0}),z(L)!=="svelte-kvx4he"&&(L.textContent=O);for(let Ht=0;Ht<ke.length;Ht+=1)ke[Ht].l(zt);zt.forEach(f),Wt.forEach(f),R=E(dt),$=u(dt,"DIV",{class:!0});var xt=v($);de=A(xt,Q),ee=A(xt," of "),ae=A(xt,se),Ve=A(xt," licenses"),xt.forEach(f),dt.forEach(f),Je.forEach(f),ve=E(qe),G=u(qe,"DIV",{class:!0});var $t=v(G);oe=u($t,"DIV",{class:!0});var Xt=v(oe);J.l(Xt),Xt.forEach(f),pe=E($t),Ee=u($t,"DIV",{class:!0});var Nt=v(Ee);De=u(Nt,"DIV",{class:!0});var St=v(De);_e=u(St,"DIV",{class:!0});var Tt=v(_e);Le=u(Tt,"LABEL",{for:!0,class:!0,"data-svelte-h":!0}),z(Le)!=="svelte-ql7zxs"&&(Le.textContent=ie),ce=E(Tt),x=u(Tt,"SELECT",{id:!0,class:!0});var Ct=v(x);P=u(Ct,"OPTION",{"data-svelte-h":!0}),z(P)!=="svelte-18d3dpq"&&(P.textContent=be),he=u(Ct,"OPTION",{"data-svelte-h":!0}),z(he)!=="svelte-1k18a0a"&&(he.textContent=Me),Y=u(Ct,"OPTION",{"data-svelte-h":!0}),z(Y)!=="svelte-ujtx1y"&&(Y.textContent=Re),w=u(Ct,"OPTION",{"data-svelte-h":!0}),z(w)!=="svelte-ic6cau"&&(w.textContent=re),ye=u(Ct,"OPTION",{"data-svelte-h":!0}),z(ye)!=="svelte-1nhtptg"&&(ye.textContent=tt),Ie=u(Ct,"OPTION",{"data-svelte-h":!0}),z(Ie)!=="svelte-1148cjc"&&(Ie.textContent=_t),Ct.forEach(f),lt=E(Tt),Be=u(Tt,"SPAN",{class:!0,"data-svelte-h":!0}),z(Be)!=="svelte-1mtc279"&&(Be.textContent=Ge),Tt.forEach(f),vt=E(St),je=u(St,"DIV",{class:!0});var pt=v(je);Fe=A(pt,"Showing "),Ae=A(pt,$e),Ke=A(pt," to "),bt=A(pt,it),nt=A(pt," of "),Te=A(pt,me),st=A(pt," licenses"),pt.forEach(f),St.forEach(f),we=E(Nt),He&&He.l(Nt),Nt.forEach(f),$t.forEach(f),qe.forEach(f),xe=E(m),Oe(fe.$$.fragment,m),Ye=E(m),Oe(Qe.$$.fragment,m),j=E(m),Oe(W.$$.fragment,m),Ze=E(m),Oe(ze.$$.fragment,m),this.h()},h(){document.title="Licenses - Sigma Permit",c(h,"class","btn btn-primary p-2"),c(h,"title","Refresh"),c(b,"class","btn btn-primary flex items-center space-x-2"),c(o,"class","flex items-center space-x-3"),c(l,"class","flex items-center justify-between"),c(q,"type","text"),c(q,"placeholder","Search licenses..."),c(q,"class","form-input w-full"),c(X,"class","flex-1"),L.__value="",ge(L,L.__value),c(g,"class","form-input"),n[4]===void 0&&At(()=>n[26].call(g)),c(C,"class","flex items-center space-x-2"),c($,"class","text-sm text-gray-600 dark:text-gray-400"),c(S,"class","flex flex-col sm:flex-row gap-4"),c(N,"class","card p-4"),c(oe,"class","table-container"),c(Le,"for","pageSize"),c(Le,"class","text-sm text-gray-600 dark:text-gray-400"),P.__value=10,ge(P,P.__value),he.__value=20,ge(he,he.__value),Y.__value=50,ge(Y,Y.__value),w.__value=100,ge(w,w.__value),ye.__value=150,ge(ye,ye.__value),Ie.__value=200,ge(Ie,Ie.__value),c(x,"id","pageSize"),c(x,"class","form-input w-20"),n[7]===void 0&&At(()=>n[31].call(x)),c(Be,"class","text-sm text-gray-600 dark:text-gray-400"),c(_e,"class","flex items-center space-x-2"),c(je,"class","text-sm text-gray-600 dark:text-gray-400"),c(De,"class","flex items-center space-x-4"),c(Ee,"class","flex items-center justify-between px-6 py-4 border-t border-gray-200 dark:border-gray-700"),c(G,"class","card"),c(t,"class","space-y-6")},m(m,V){te(m,e,V),te(m,t,V),s(t,l),s(l,a),s(l,i),s(l,o),s(o,h),Se(y,h,null),s(o,_),s(o,b),Se(p,b,null),s(b,k),s(b,D),s(t,H),s(t,N),s(N,S),s(S,X),s(X,q),ge(q,n[3]),s(S,F),s(S,C),s(C,g),s(g,L);for(let qe=0;qe<ke.length;qe+=1)ke[qe]&&ke[qe].m(g,null);mt(g,n[4],!0),s(S,R),s(S,$),s($,de),s($,ee),s($,ae),s($,Ve),s(t,ve),s(t,G),s(G,oe),et[M].m(oe,null),s(G,pe),s(G,Ee),s(Ee,De),s(De,_e),s(_e,Le),s(_e,ce),s(_e,x),s(x,P),s(x,he),s(x,Y),s(x,w),s(x,ye),s(x,Ie),mt(x,n[7],!0),s(_e,lt),s(_e,Be),s(De,vt),s(De,je),s(je,Fe),s(je,Ae),s(je,Ke),s(je,bt),s(je,nt),s(je,Te),s(je,st),s(Ee,we),He&&He.m(Ee,null),te(m,xe,V),Se(fe,m,V),te(m,Ye,V),Se(Qe,m,V),te(m,j,V),Se(W,m,V),te(m,Ze,V),Se(ze,m,V),Ue=!0,yt||(We=[le(h,"click",n[24]),le(b,"click",n[16]),le(q,"input",n[25]),le(g,"change",n[26]),le(g,"change",n[23]),le(x,"change",n[31]),le(x,"change",n[32])],yt=!0)},p(m,V){if(V[0]&8&&q.value!==m[3]&&ge(q,m[3]),V[0]&8192){Xe=ot(m[13]);let Je;for(Je=0;Je<Xe.length;Je+=1){const dt=hl(m,Xe,Je);ke[Je]?ke[Je].p(dt,V):(ke[Je]=pl(dt),ke[Je].c(),ke[Je].m(g,null))}for(;Je<ke.length;Je+=1)ke[Je].d(1);ke.length=Xe.length}V[0]&8208&&mt(g,m[4]),(!Ue||V[0]&1)&&se!==(se=m[0].length+"")&&Ce(ae,se);let qe=M;M=rt(m),M===qe?et[M].p(m,V):(Bt(),ue(et[qe],1,1,()=>{et[qe]=null}),jt(),J=et[M],J?J.p(m,V):(J=et[M]=wt[M](m),J.c()),ne(J,1),J.m(oe,null)),V[0]&128&&mt(x,m[7]),(!Ue||V[0]&161)&&$e!==($e=Math.min((m[5]-1)*m[7]+1,m[0].length)+"")&&Ce(Ae,$e),(!Ue||V[0]&161)&&it!==(it=Math.min(m[5]*m[7],m[0].length)+"")&&Ce(bt,it),(!Ue||V[0]&1)&&me!==(me=m[0].length+"")&&Ce(Te,me),m[6]>1?He?He.p(m,V):(He=vl(m),He.c(),He.m(Ee,null)):He&&(He.d(1),He=null);const ct={};V[0]&256&&(ct.onClose=m[39]),V[0]&8450|V[1]&1073741824&&(ct.$$scope={dirty:V,ctx:m}),!Et&&V[0]&256&&(Et=!0,ct.open=m[8],Pt(()=>Et=!1)),fe.$set(ct);const ut={};V[0]&512&&(ut.onClose=m[42]),V[0]&12802|V[1]&1073741824&&(ut.$$scope={dirty:V,ctx:m}),!I&&V[0]&512&&(I=!0,ut.open=m[9],Pt(()=>I=!1)),Qe.$set(ut);const kt={};V[0]&2048&&(kt.onClose=m[45]),V[0]&6144|V[1]&1073741824&&(kt.$$scope={dirty:V,ctx:m}),!Z&&V[0]&2048&&(Z=!0,kt.open=m[11],Pt(()=>Z=!1)),W.$set(kt);const ht={};V[0]&5120|V[1]&1073741824&&(ht.$$scope={dirty:V,ctx:m}),!at&&V[0]&1024&&(at=!0,ht.open=m[10],Pt(()=>at=!1)),ze.$set(ht)},i(m){Ue||(ne(y.$$.fragment,m),ne(p.$$.fragment,m),ne(J),ne(fe.$$.fragment,m),ne(Qe.$$.fragment,m),ne(W.$$.fragment,m),ne(ze.$$.fragment,m),Ue=!0)},o(m){ue(y.$$.fragment,m),ue(p.$$.fragment,m),ue(J),ue(fe.$$.fragment,m),ue(Qe.$$.fragment,m),ue(W.$$.fragment,m),ue(ze.$$.fragment,m),Ue=!1},d(m){m&&(f(e),f(t),f(xe),f(Ye),f(j),f(Ze)),Ne(y),Ne(p),It(ke,m),et[M].d(),He&&He.d(),Ne(fe,m),Ne(Qe,m),Ne(W,m),Ne(ze,m),yt=!1,Lt(We)}}}function pn(n,e,t){let l=[],a=[],r=!0,i="",o="",h=1,y=1,_=10,b=!1,p=!1,k=!1,D=!1,B=null,H=[];Ul(async()=>{sessionStorage.getItem("access_token")&&await Promise.all([N(),S(),X()])});async function N(w=1){try{t(2,r=!0),t(5,h=w);const re=await Dt.getLicenses(w,_,o||void 0);t(0,l=re.items||[]),t(6,y=Math.ceil((re.total||0)/_)),console.log("Loaded licenses:",l.length),l.length>0&&console.log("Sample license with tenant_name:",{id:l[0].id,tenant_id:l[0].tenant_id,tenant_name:l[0].tenant_name})}catch(re){console.error("Error loading licenses:",re),ft.error("Failed to load licenses")}finally{t(2,r=!1)}}async function S(){try{const w=await Bl.getTenants(1,200);t(13,H=w.items||[]),console.log("Loaded tenants for forms:",H.length)}catch(w){console.error("Error loading tenants:",w)}}async function X(){try{const w=await jl.getTemplates(1,200);t(1,a=w.items||[])}catch(w){console.error("Error loading templates:",w)}}function q(){return i?l.filter(w=>w.id.toString().includes(i)||w.tenant_name.toLowerCase().includes(i.toLowerCase())):l}function F(){t(12,B=null),t(8,b=!0)}function C(w){t(12,B=w),t(9,p=!0)}function g(w){t(12,B=w),t(10,k=!0)}function L(w){t(12,B=w),t(11,D=!0)}async function O(w){try{console.log("Downloading license:",w.id),console.log("License key:",w.license_key),await Dt.downloadLicense(w.license_key),ft.success(`License Download Complete
The license file has been downloaded successfully.`)}catch(re){console.error("Error downloading license:",re),ft.error("Failed to download license file")}}async function R(){if(B)try{await Dt.deleteLicense(B.id),ft.success("License revoked successfully"),t(10,k=!1),await N(h)}catch(w){console.error("Error deleting license:",w)}}async function $(){t(8,b=!1),t(9,p=!1),setTimeout(()=>N(h),500)}function Q(){t(5,h=1),N(1)}const de=()=>N(h);function ee(){i=this.value,t(3,i)}function se(){o=Ut(this),t(4,o),t(13,H)}const ae=w=>L(w),Ve=w=>O(w),ve=w=>C(w),G=w=>g(w);function oe(){_=Ut(this),t(7,_)}const K=()=>{t(5,h=1),N(1)},M=()=>N(1),J=()=>N(h-1),pe=w=>N(w),Ee=()=>N(h+1),De=()=>N(y),_e=()=>t(8,b=!1),Le=()=>t(8,b=!1);function ie(w){b=w,t(8,b)}const ce=()=>t(9,p=!1),x=()=>t(9,p=!1);function P(w){p=w,t(9,p)}const be=()=>t(11,D=!1),he=()=>t(11,D=!1);function Me(w){D=w,t(11,D)}const Y=()=>t(10,k=!1);function Re(w){k=w,t(10,k)}return[l,a,r,i,o,h,y,_,b,p,k,D,B,H,N,q,F,C,g,L,O,R,$,Q,de,ee,se,ae,Ve,ve,G,oe,K,M,J,pe,Ee,De,_e,Le,ie,ce,x,P,be,he,Me,Y,Re]}class xn extends Ft{constructor(e){super(),Rt(this,e,pn,hn,Jt,{},null,[-1,-1])}}export{xn as component};
