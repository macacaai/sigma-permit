import{s as vt,d as u,i as G,b as n,l as xt,m as g,o as kt,g as S,c as f,e as x,p as Y,j as w,h,q as yt,n as nt,r as $t,a as W,f as X,t as Z}from"../chunks/BM_9wLIj.js";import{S as Dt,i as Et,d as tt,t as j,a as B,c as mt,m as et,b as at,e as rt,g as bt}from"../chunks/DQoX3H7n.js";import{s as Tt,t as St,e as ht}from"../chunks/CEGMbthI.js";import{R as wt,P as Ct,S as Lt,T as It}from"../chunks/lZ7b4qBu.js";import{U as Pt}from"../chunks/wIpm3dzG.js";function gt(b,t,s){const i=b.slice();return i[6]=t[s],i}function Ut(b){let t,s,i='<tr><th>Tenant</th> <th>Plan</th> <th>Status</th> <th>Start Date</th> <th>End Date</th> <th class="text-right">Actions</th></tr>',c,k,v,o=ht(b[0]),r=[];for(let e=0;e<o.length;e+=1)r[e]=_t(gt(b,o,e));const p=e=>j(r[e],1,1,()=>{r[e]=null});return{c(){t=h("table"),s=h("thead"),s.innerHTML=i,c=w(),k=h("tbody");for(let e=0;e<r.length;e+=1)r[e].c();this.h()},l(e){t=f(e,"TABLE",{class:!0});var a=x(t);s=f(a,"THEAD",{"data-svelte-h":!0}),Y(s)!=="svelte-4mmicj"&&(s.innerHTML=i),c=S(a),k=f(a,"TBODY",{});var l=x(k);for(let T=0;T<r.length;T+=1)r[T].l(l);l.forEach(u),a.forEach(u),this.h()},h(){g(t,"class","table")},m(e,a){G(e,t,a),n(t,s),n(t,c),n(t,k);for(let l=0;l<r.length;l+=1)r[l]&&r[l].m(k,null);v=!0},p(e,a){if(a&1){o=ht(e[0]);let l;for(l=0;l<o.length;l+=1){const T=gt(e,o,l);r[l]?(r[l].p(T,a),B(r[l],1)):(r[l]=_t(T),r[l].c(),B(r[l],1),r[l].m(k,null))}for(bt(),l=o.length;l<r.length;l+=1)p(l);mt()}},i(e){if(!v){for(let a=0;a<o.length;a+=1)B(r[a]);v=!0}},o(e){r=r.filter(Boolean);for(let a=0;a<r.length;a+=1)j(r[a]);v=!1},d(e){e&&u(t),$t(r,e)}}}function Mt(b){let t,s,i,c,k="No subscriptions found",v,o,r="Get started by creating your first subscription.",p;return s=new Pt({props:{class:"mx-auto text-gray-400 dark:text-gray-500 mb-4",size:48}}),{c(){t=h("div"),rt(s.$$.fragment),i=w(),c=h("h3"),c.textContent=k,v=w(),o=h("p"),o.textContent=r,this.h()},l(e){t=f(e,"DIV",{class:!0});var a=x(t);at(s.$$.fragment,a),i=S(a),c=f(a,"H3",{class:!0,"data-svelte-h":!0}),Y(c)!=="svelte-166bhci"&&(c.textContent=k),v=S(a),o=f(a,"P",{class:!0,"data-svelte-h":!0}),Y(o)!=="svelte-y793uq"&&(o.textContent=r),a.forEach(u),this.h()},h(){g(c,"class","text-lg font-medium text-gray-900 dark:text-gray-50 mb-2"),g(o,"class","text-gray-600 dark:text-gray-400 mb-4"),g(t,"class","text-center py-12")},m(e,a){G(e,t,a),et(s,t,null),n(t,i),n(t,c),n(t,v),n(t,o),p=!0},p:nt,i(e){p||(B(s.$$.fragment,e),p=!0)},o(e){j(s.$$.fragment,e),p=!1},d(e){e&&u(t),tt(s)}}}function Vt(b){let t,s='<div class="spinner mr-3"></div> <span class="text-gray-600 dark:text-gray-400">Loading subscriptions...</span>';return{c(){t=h("div"),t.innerHTML=s,this.h()},l(i){t=f(i,"DIV",{class:!0,"data-svelte-h":!0}),Y(t)!=="svelte-1e8m8df"&&(t.innerHTML=s),this.h()},h(){g(t,"class","flex items-center justify-center py-12")},m(i,c){G(i,t,c)},p:nt,i:nt,o:nt,d(i){i&&u(t)}}}function _t(b){var q,J;let t,s,i=(((q=b[6].tenant)==null?void 0:q.name)||"Unknown")+"",c,k,v,o=(((J=b[6].plan)==null?void 0:J.name)||"Unknown")+"",r,p,e,a,l=b[6].status+"",T,U,R,V,L=new Date(b[6].start_date).toLocaleDateString()+"",I,D,y,H=(b[6].end_date?new Date(b[6].end_date).toLocaleDateString():"-")+"",z,F,N,$,A,d,M,E,P,O,C;return d=new Lt({props:{size:16}}),P=new It({props:{size:16}}),{c(){t=h("tr"),s=h("td"),c=Z(i),k=w(),v=h("td"),r=Z(o),p=w(),e=h("td"),a=h("span"),T=Z(l),R=w(),V=h("td"),I=Z(L),D=w(),y=h("td"),z=Z(H),F=w(),N=h("td"),$=h("div"),A=h("button"),rt(d.$$.fragment),M=w(),E=h("button"),rt(P.$$.fragment),O=w(),this.h()},l(_){t=f(_,"TR",{class:!0});var m=x(t);s=f(m,"TD",{class:!0});var K=x(s);c=X(K,i),K.forEach(u),k=S(m),v=f(m,"TD",{class:!0});var Q=x(v);r=X(Q,o),Q.forEach(u),p=S(m),e=f(m,"TD",{});var lt=x(e);a=f(lt,"SPAN",{class:!0});var ot=x(a);T=X(ot,l),ot.forEach(u),lt.forEach(u),R=S(m),V=f(m,"TD",{class:!0});var it=x(V);I=X(it,L),it.forEach(u),D=S(m),y=f(m,"TD",{class:!0});var ct=x(y);z=X(ct,H),ct.forEach(u),F=S(m),N=f(m,"TD",{class:!0});var dt=x(N);$=f(dt,"DIV",{class:!0});var st=x($);A=f(st,"BUTTON",{class:!0,title:!0});var ut=x(A);at(d.$$.fragment,ut),ut.forEach(u),M=S(st),E=f(st,"BUTTON",{class:!0,title:!0});var ft=x(E);at(P.$$.fragment,ft),ft.forEach(u),st.forEach(u),dt.forEach(u),O=S(m),m.forEach(u),this.h()},h(){g(s,"class","font-medium text-gray-900 dark:text-gray-50"),g(v,"class","text-gray-600 dark:text-gray-400"),g(a,"class",U="inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium "+(b[6].status==="active"?"bg-green-100 text-green-800 dark:bg-green-900/20 dark:text-green-400":b[6].status==="trialing"?"bg-blue-100 text-blue-800 dark:bg-blue-900/20 dark:text-blue-400":"bg-red-100 text-red-800 dark:bg-red-900/20 dark:text-red-400")),g(V,"class","text-gray-900 dark:text-gray-50"),g(y,"class","text-gray-600 dark:text-gray-400"),g(A,"class","p-1 text-gray-400 dark:text-gray-500 hover:text-blue-500 rounded"),g(A,"title","Edit subscription"),g(E,"class","p-1 text-gray-400 dark:text-gray-500 hover:text-red-500 rounded"),g(E,"title","Delete subscription"),g($,"class","flex items-center justify-end space-x-2"),g(N,"class","text-right"),g(t,"class","hover:bg-gray-50 dark:hover:bg-gray-800")},m(_,m){G(_,t,m),n(t,s),n(s,c),n(t,k),n(t,v),n(v,r),n(t,p),n(t,e),n(e,a),n(a,T),n(t,R),n(t,V),n(V,I),n(t,D),n(t,y),n(y,z),n(t,F),n(t,N),n(N,$),n($,A),et(d,A,null),n($,M),n($,E),et(P,E,null),n(t,O),C=!0},p(_,m){var K,Q;(!C||m&1)&&i!==(i=(((K=_[6].tenant)==null?void 0:K.name)||"Unknown")+"")&&W(c,i),(!C||m&1)&&o!==(o=(((Q=_[6].plan)==null?void 0:Q.name)||"Unknown")+"")&&W(r,o),(!C||m&1)&&l!==(l=_[6].status+"")&&W(T,l),(!C||m&1&&U!==(U="inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium "+(_[6].status==="active"?"bg-green-100 text-green-800 dark:bg-green-900/20 dark:text-green-400":_[6].status==="trialing"?"bg-blue-100 text-blue-800 dark:bg-blue-900/20 dark:text-blue-400":"bg-red-100 text-red-800 dark:bg-red-900/20 dark:text-red-400")))&&g(a,"class",U),(!C||m&1)&&L!==(L=new Date(_[6].start_date).toLocaleDateString()+"")&&W(I,L),(!C||m&1)&&H!==(H=(_[6].end_date?new Date(_[6].end_date).toLocaleDateString():"-")+"")&&W(z,H)},i(_){C||(B(d.$$.fragment,_),B(P.$$.fragment,_),C=!0)},o(_){j(d.$$.fragment,_),j(P.$$.fragment,_),C=!1},d(_){_&&u(t),tt(d),tt(P)}}}function Ht(b){let t,s,i,c,k='<h1 class="text-3xl font-bold text-gray-900 dark:text-gray-50">Subscriptions</h1> <p class="text-gray-600 dark:text-gray-400 mt-2">Manage tenant subscriptions</p>',v,o,r,p,e,a,l,T,U,R="Add Subscription",V,L,I,D,y,H,z,F;p=new wt({props:{size:18}}),l=new Ct({props:{size:18}});const N=[Vt,Mt,Ut],$=[];function A(d,M){return d[1]?0:d[0].length===0?1:2}return D=A(b),y=$[D]=N[D](b),{c(){t=w(),s=h("div"),i=h("div"),c=h("div"),c.innerHTML=k,v=w(),o=h("div"),r=h("button"),rt(p.$$.fragment),e=w(),a=h("button"),rt(l.$$.fragment),T=w(),U=h("span"),U.textContent=R,V=w(),L=h("div"),I=h("div"),y.c(),this.h()},l(d){kt("svelte-ohagau",document.head).forEach(u),t=S(d),s=f(d,"DIV",{class:!0});var E=x(s);i=f(E,"DIV",{class:!0});var P=x(i);c=f(P,"DIV",{"data-svelte-h":!0}),Y(c)!=="svelte-xa6eil"&&(c.innerHTML=k),v=S(P),o=f(P,"DIV",{class:!0});var O=x(o);r=f(O,"BUTTON",{class:!0,title:!0});var C=x(r);at(p.$$.fragment,C),C.forEach(u),e=S(O),a=f(O,"BUTTON",{class:!0});var q=x(a);at(l.$$.fragment,q),T=S(q),U=f(q,"SPAN",{"data-svelte-h":!0}),Y(U)!=="svelte-1gj77ty"&&(U.textContent=R),q.forEach(u),O.forEach(u),P.forEach(u),V=S(E),L=f(E,"DIV",{class:!0});var J=x(L);I=f(J,"DIV",{class:!0});var _=x(I);y.l(_),_.forEach(u),J.forEach(u),E.forEach(u),this.h()},h(){document.title="Subscriptions - Sigma Permit",g(r,"class","btn btn-primary p-2"),g(r,"title","Refresh"),g(a,"class","btn btn-primary flex items-center space-x-2"),g(o,"class","flex items-center space-x-3"),g(i,"class","flex items-center justify-between"),g(I,"class","table-container"),g(L,"class","card"),g(s,"class","space-y-6")},m(d,M){G(d,t,M),G(d,s,M),n(s,i),n(i,c),n(i,v),n(i,o),n(o,r),et(p,r,null),n(o,e),n(o,a),et(l,a,null),n(a,T),n(a,U),n(s,V),n(s,L),n(L,I),$[D].m(I,null),H=!0,z||(F=xt(r,"click",b[4]),z=!0)},p(d,[M]){let E=D;D=A(d),D===E?$[D].p(d,M):(bt(),j($[E],1,1,()=>{$[E]=null}),mt(),y=$[D],y?y.p(d,M):(y=$[D]=N[D](d),y.c()),B(y,1),y.m(I,null))},i(d){H||(B(p.$$.fragment,d),B(l.$$.fragment,d),B(y),H=!0)},o(d){j(p.$$.fragment,d),j(l.$$.fragment,d),j(y),H=!1},d(d){d&&(u(t),u(s)),tt(p),tt(l),$[D].d(),z=!1,F()}}}let pt=10;function At(b,t,s){let i=[],c=!0,k=1,v=1;yt(async()=>{sessionStorage.getItem("access_token")&&await o()});async function o(p=1){try{s(1,c=!0),s(2,k=p);const e=await Tt.getSubscriptions(p,pt);s(0,i=e.items||[]),v=Math.ceil((e.total||0)/pt)}catch(e){console.error("Error loading subscriptions:",e),St.error("Failed to load subscriptions")}finally{s(1,c=!1)}}return[i,c,k,o,()=>o(k)]}class qt extends Dt{constructor(t){super(),Et(this,t,At,Ht,vt,{})}}export{qt as component};
